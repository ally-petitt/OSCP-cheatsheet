# Specific Exploits (CVEs)

# SMBGhost (CVE-2020-0796) Local Privilege Escalation  (LPE)

This video does a good walkthrough of how to exploit it for local privilege escalation.

[https://youtu.be/a0Vf8VLgzhc](https://youtu.be/a0Vf8VLgzhc)

# Exploiting file write to get a system shell

If you have privileges like this

```bash
C:\xampp\htdocs\uploads>icacls C:/Windows
C:/Windows NT SERVICE\TrustedInstaller:(F)
           NT SERVICE\TrustedInstaller:(CI)(IO)(F)
           NT AUTHORITY\SYSTEM:(M)
           NT AUTHORITY\SYSTEM:(OI)(CI)(IO)(F)
           BUILTIN\Users:(M)
           BUILTIN\Users:(OI)(CI)(IO)(F)

### OR THIS
PS C:\tmp> icacls C:/Windows
C:/Windows NT SERVICE\TrustedInstaller:(F)
           NT SERVICE\TrustedInstaller:(CI)(IO)(F)
           NT AUTHORITY\SYSTEM:(M)
           NT AUTHORITY\SYSTEM:(OI)(CI)(IO)(F)
           BUILTIN\Administrators:(M)
           BUILTIN\Administrators:(OI)(CI)(IO)(F)
           BUILTIN\Users:(RX)
           BUILTIN\Users:(OI)(CI)(IO)(GR,GE)
           CREATOR OWNER:(OI)(CI)(IO)(F)
           APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(RX)
           APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)
           APPLICATION PACKAGE AUTHORITY\ALL RESTRICTED APPLICATION PACKAGES:(RX)
           APPLICATION PACKAGE AUTHORITY\ALL RESTRICTED APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE)
```

You can get a shell as system

Visit here [https://github.com/sailay1996/WerTrigger/tree/master/bin](https://github.com/sailay1996/WerTrigger/tree/master/bin) 

1. Copy **phoneinfo.dll** to **C:\Windows\System32**
2. Place **Report.wer** file and **WerTrigger.exe** in a same directory.
3. Run **WerTrigger.exe**.

# SeRestorePrivilege

We exploit this in Heist OSPG [https://www.notion.so/Privilege-Escalation-Svc_apache-Administrator-5a786fad109a4b6fa4f49c1419ab4c93#16aee4ae67cc477091354a8ee6f28b08](https://www.notion.so/Privilege-Escalation-Svc_apache-Administrator-5a786fad109a4b6fa4f49c1419ab4c93)

# SeBackupPrivilege

[Priv2Admin/SeBackupPrivilege.md at master · gtworek/Priv2Admin](https://github.com/gtworek/Priv2Admin/blob/master/SeBackupPrivilege.md)